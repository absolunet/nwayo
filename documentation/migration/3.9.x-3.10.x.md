# 3.9.x â†’ 3.10.x
[View the source differences on GitHub](https://github.com/valtech-commerce/nwayo/compare/3.9.0...3.10.0)

## Key changes
- Add bundled ESLint/stylelint configuration
- Add option to use the workflow without the global CLI
- Add option to use global standalone Dart Sass compiler
- Remove some internal Sass functions



## What to do
- Update version `package.json` (duh...)



## Use bundled configuration

### Change your `.eslintrc.yaml`

#### Classic rules
```yaml
extends:
  - "./node_modules/@absolunet/nwayo-workflow/config/eslint.cjs"
  - "./node_modules/@absolunet/nwayo-workflow/config/eslint-no-prettier.cjs"
```

#### Prettier flavoured
```yaml
extends:
  - "./node_modules/@absolunet/nwayo-workflow/config/eslint.cjs"
```

### Change your `.stylelintrc.yaml`
A lot of the new rules are autofixable. It is recommended to implement and run the `fix:stylelint` npm script described in another section below.

Here you have the choice of either stay with classic rules or self-manage a [Prettier](https://prettier.io/) installation.

#### Classic rules
Change your `./.stylelintrc.yaml` to reinstate pre-Prettier rules in your project.

**IMPORTANT**: You will have "Deprecation warnings", as these rules will eventually be removed.

```yaml
extends:
 - "./node_modules/@absolunet/nwayo-workflow/config/stylelint.cjs"
 - "./node_modules/@absolunet/nwayo-workflow/config/stylelint-no-prettier.cjs"
```

#### Prettier
> Taking for granted that Prettier is already enabled for scripts, or follow up instructions from the [previous migration](./3.8.x-3.9.x.md).

Change your `./.stylelintrc.yaml` to use bundled configuration.

```yaml
extends:
 - "./node_modules/@absolunet/nwayo-workflow/config/stylelint.cjs"
```

Add style files to `./.prettierignore`
```config
# [...]
!*.scss
```

## Use bundled CLI (optional)

### Use npm scripts to use included binary
Inside your `./package.json` add scripts to call nwayo commands

```json
{
  "scripts": {
    "build-<task>": "nwayo-cli run <task>",
    "rebuild": "nwayo-cli rebuild",
    "watch": "nwayo-cli watch"
  }
}
```

```shell
# Old CLI calls
nwayo run <task>
nwayo rebuild
nwayo watch

# New CLI calls
npm run build-<task>
npm run rebuild
npm run watch
```

### Optionally use npm scripts to create and document custom commands

For example:
```json
{
  "scripts": {
    "lint": "nwayo-cli run scripts-lint && nwayo-cli run styles-lint && npm run lint:prettier",
    "lint:prettier": "prettier --check .",
    "fix": "npm run fix:prettier && npm run fix:eslint && npm run fix:stylelint",
    "fix:prettier": "prettier --write .",
    "fix:eslint": "eslint --fix --ext .js .",
    "fix:stylelint": "stylelint --fix \"**/*.scss\"",
    "code-xyz": "nwayo-cli run scripts xyz && nwayo-cli run styles xyz",
    "generate-all": "nwayo-cli rebuild && cd .. && grunt less"
  }
}
```

```shell
npm run lint
npm run lint:prettier

npm run fix
npm run fix:prettier
npm run fix:eslint
npm run fix:stylelint

npm run code-xyz
npm run generate-all
```

### Optionally remove the global CLI, too keep a clean workstation
```shell
npm uninstall --global @absolunet/nwayo-cli
```

## Use global standalone Dart Sass compiler (optional)

The standalone Dart Sass compiler is way faster than the pure JavaScript version embedded in nwayo. But it needs to be installed manually on the workstation. Here's what to do, if you want to use it.

### Install the Dart Sass standalone compiler

Follow the instructions on the installation page and make sure that the `sass` command works:
[https://sass-lang.com/install](https://sass-lang.com/install)


### Enable feature in the project configuration

Edit your `./nwayo.yaml` to add this configuration

```yaml
useGlobalDartSassCompiler: true
```



## Make sure these internal Sass functions are not in your code
Some internal Sass functions from the toolbox and the main compiler have been removed.
They should not have been used outside the toolbox, but if your project has been using them, you will have to replace them with one of the new PostCSS functions.

#### `nwayo-cacheinvalidator-querystring()`, `nwayodart-checksum()`
Added a checksum value at the end of an asset URL. Have been implemented in:
- `nwayopostcss-url-image()`
- `nwayopostcss-url-woff-woff2()`

#### `nwayo-color-replace()`, `nwayo-svg-data-uri()`
Replaced a hex color in a string, escaped a svg string to be used as a data URI. Have been implemented in:
- `nwayopostcss-svg-image()`

#### `nwayodart-inline-file()`
Converted an image to a Base64 data URI. Has been replaced by:
- `nwayopostcss-base64-image()`

#### `nwayodart-file-exists()`, `nwayodart-read-file()`
Utilities to read files on the disk. Have not been replaced.

**Reference**:
- PostCSS functions: [https://github.com/valtech-commerce/nwayo/blob/3.10.0/packages/workflow/helpers/postcss-functions.js](https://github.com/valtech-commerce/nwayo/blob/3.10.0/packages/workflow/helpers/postcss-functions.js)
- Examples of usage in the toolbox: [https://github.com/valtech-commerce/nwayo/blob/3.10.0/packages/toolbox/styles/_mixins-core.scss](https://github.com/valtech-commerce/nwayo/blob/3.10.0/packages/toolbox/styles/_mixins-core.scss)
